@model IEnumerable<MVC_API_DoAn.Models.DTO.NhanViendto>
@{
    ViewData["Title"] = "TrangChuNV";
}

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Management</title>
    <link rel="stylesheet" href="~/API_DoAnassets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/API_DoAn/assets/theme/Employee.css">
</head>

<body>
    <div class="container mt-5">
        <h2 class="text-center mb-4">Employee Management</h2>
        <div class="text-right mb-3">
            <a class="btn btn-primary" asp-controller="NhanVien" asp-action="AddNhanVien">Add Employee</a>
        </div>

        <div class="row mt-4" id="employee-list">
            <!-- Dữ liệu nhân viên tĩnh -->
            @foreach (var item in Model)
            {
                <div class="col-md-4">
                    <div class="card mb-4">
                        <img style="height:500px;" src="~/API_DoAn/assets/Anh/@item.ImgNV" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">@item.TenNV</h5>
                            <p class="card-text">Email: @item.Email</p>
                            <p class="card-text">Phone: @item.SDT</p>
                            <p class="card-text">Address: @item.DiaChi</p>
                            <div style="display:flex; gap:15px; flex-wrap:wrap;">
                            <a asp-controller="NhanVien" asp-action="EditNhanVien" asp-route-id="@item.Id" class="btn btn-warning">Edit</a>
                            <form   style="width:30%; position:relative;top:8px;" asp-controller="NhanVien" asp-action="DeleteNhanVien" method="post">
                                <input  type="hidden" name="id" value="@item.Id" />
                                <button class="btn btn-danger" type="submit">Delete</button>
                            </form>
                            </div>
                        </div>
                    </div>
                </div>
            }
             </div>
    </div>
            <script src="~/API_DoAn/assets/bootstrap/js/bootstrap.bundle.min.js"></script>

    <script>
        function confirmDelete(id) {
            if (confirm('Bạn có chắc muốn xóa nhân viên này không?')) {
                deleteEmployee(id);
            }
        }

        function deleteEmployee(id) {
            fetch(`/NhanVien/DeleteNhanVien/${id}`, {
                method: 'DELETE'
            })
                .then(response => {
                    if (response.ok) {
                        // Xóa nhân viên thành công, có thể thực hiện các hành động cần thiết ở đây
                        // Ví dụ: cập nhật lại danh sách nhân viên trên trang
                        window.location.reload();
                    } else {
                        alert('Xóa nhân viên thất bại. Vui lòng thử lại.');
                    }
                })
                .catch(error => {
                    console.error('Lỗi khi gửi yêu cầu DELETE:', error);
                    alert('Có lỗi xảy ra. Vui lòng thử lại.');
                });
        }
    </script>

</body>

</html>
